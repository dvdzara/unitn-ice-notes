# yaml-language-server: $schema=https://raw.githubusercontent.com/woodpecker-ci/woodpecker/main/pipeline/frontend/yaml/linter/schema/schema.json

steps:
  - commands:
      - corepack enable
      - pnpm config set store-dir /pnpm
      - pnpm install
    image: docker.io/library/node:22.9.0-bookworm
    name: setup-pnpm
    volumes:
      - woodpecker-repo-${CI_REPO_REMOTE_ID}-pnpm:/pnpm
  - commands:
      - trivy repository --scanners vuln,secret,misconfig --dependency-tree --skip-dirs node_modules .
    image: docker.io/aquasec/trivy:0.56.1
    name: check-trivy

when:
  - event: pull_request
